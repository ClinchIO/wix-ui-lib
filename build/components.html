<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Wix UI-Lib Components demo</title>
    <link rel="stylesheet" href="../build/ui-lib.min.css"/>
	
    <style>
	
        *, *:before, *:after {
            -webkit-box-sizing: border-box;
            -moz-box-sizing: border-box;
            box-sizing: border-box;
        }
		
		h1{
			padding: 10px 0;
			margin: 0;
		}
		ul, li {
			padding:0;
			margin:0;
		}
		
        .container {
            width: 970px;
            margin: 0 auto;
			overflow: hidden;
        }
		.fixed{
			position:fixed;
		}

        .nav {
            list-style: none;
			display:none;
        }

		.float-left{
			float:left;
		}

		#main {
			float:left;
			width: 670px;
		}	
		#sidebar {
			float:left;	
			width: 280px;
			min-height: 1px;			
		}
		.side-bar ul {
			list-style: none;
		}		
		.cmp-sidebar{
			position: fixed;
		    color: #ffffff;
            /*padding: 20px 15px;*/
			top: 80px;
			border-radius: 4px;
  		    background-color: #0099FF;
            border: 1px solid #0077CC;
		}
		.plugin-markup, .plugin-options{
			word-break: break-word;
			padding: 5px;
			background-color:rgba(127,127,127,0.04);
			border: 1px solid rgba(127,127,127,0.3);
			border-radius:4px;
		}
		.cmp-plugin-decs-entry{
			border-top: 5px solid rgba(0,0,0,0.3);
			margin: 10px 0 30px 0;
			padding: 0 0 20px 0;
		}
		        .cmp-plugin-entry{
			
        }


		.cmp-plugin-entry > a{
			color: #ffffff;		
			display:block;
			text-decoration: none;
			padding: 4px 15px;
			transition:all 0.3s;
			background:transparent;
		}
				
		.cmp-plugin-entry:first-child, .cmp-plugin-entry:first-child a{
			border-radius: 3px 3px 0 0;
		}
		
		.cmp-plugin-entry:last-child, .cmp-plugin-entry:last-child a{
			border-radius: 0 0 3px 3px;
		}
	    .cmp-plugin-entry a:hover {
            background: rgba(255,255,255,0.5);
        }

		.cmp-plugin-entry .current-viewed{
			background-color: rgba(0,0,0,0.25);          
		}
	
		table {
		  border-collapse: collapse;
		  width: 100%;
		}
		th, td {
		  padding: 0.25rem;
		  text-align: left;
		  border: 1px solid rgba(0,0,0,0.05);
		  white-space: pre-wrap;
		}
		tbody td{
			width:50%;
			
		}
		
		tbody tr:nth-child(odd) {
		  background: rgba(0,0,0,0.015);
		}
	 
    </style>
</head>
<body>
    <div class="container">
		
		<div id="sidebar" class="side-bar">			
			<h1 class="fixed">UI LIB 2.1</h1>
			<ul class="cmp-sidebar content"></ul>
		</div>
		<div id="main" class="content">
			<div id="intro">
				<h2>lorem intro</h2>
				<p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr,  sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr,  sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
				<p>Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr,  sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr,  sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.</p>
			</div>
			<div id="docs">
				<div class="content"></div>
			</div>
		</div>
    </div>

    <!-- jQuery Dependency -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <!-- Wix SDK -->
    <script src="http://sslstatic.wix.com/services/js-sdk/1.24.0/js/Wix.js"></script>
    <!-- Wix UI-LIB -->
    <script src="../build/ui-lib.min.js"></script>

	<script type="text/javascript">
		
		
		

		var pluginPresets = {
			Dropdown:{
				html: '<div value="show">Show Images</div> <div value="hide">Hide Images</div> <div value="showhover">Show Images on Hover</div>',
				optionsForPlugin:{
					width:160
				}
			},
			ToggleButtonGroup:{
				html:  '<button value="mini">Mini</button> <button value="medium">Medium</button> <button value="large">Large</button>'
			},
			ButtonGroup:{
				html:  '<button value="mini">Mini</button> <button value="medium">Medium</button> <button value="large">Large</button>'
			},
			Accordion: {
				html:'<div class="acc-pane"> <h3>Accordion Pane</h3> <div class="acc-content">Accordion Content</div></div> <div class="acc-pane"> <h3>Accordion Pane</h3> <div class="acc-content">Accordion Content</div></div> <div class="acc-pane"> <h3>Accordion Pane</h3> <div class="acc-content">Accordion Content</div></div>'
			},
			Radio:{
				html:'<div data-radio-value="sync10">Sync 10 images</div><div data-radio-value="sync25">Sync 25 images</div><div data-radio-value="sync50">Sync 50 images</div>'
			},
			Tooltip:{
				html: '<div wix-tooltip="{text: \'this is a simple tooltip\'}"><div style="width:100px">Tool</div></div>'
			},
			Slider:{
				optionsForPlugin:{
					toolTip:true
				}
			}			
		};

		function getPluginDesc(Plugin){
			var preset = pluginPresets[Plugin.name];
			return (preset && preset.description) ? preset.description : '';
		}
		function getPluginInitMarkup(Plugin){
			var preset = pluginPresets[Plugin.name];
			return (preset && preset.html) ? preset.html : '';
		}
		function getPluginInitOptions(Plugin){
			var preset = pluginPresets[Plugin.name];
			return preset ? JSON.stringify(preset.optionsForPlugin) : '{}';
		}
		function getPluginDefinitionMarkup(Plugin){
			return utils.escapeHtml('<div wix-ctrl="'+Plugin.name+'">' + getPluginInitMarkup(Plugin) + '<div>');
		}
		
		function jsonToTable(json){
		    var table_obj = $('<table>');
			$.each(json, function(index, item){				
				 var table_row = $('<tr>');
				 var table_cell = $('<td>').text(index);
				 table_row.append(table_cell);
				 var t = typeof item ==='function' ? item.toString() : JSON.stringify(item) || 'null';
				 var table_cell = $('<td>').text(t);
				 table_row.append(table_cell);
				 table_obj.append(table_row);
			});
			return '<table style="width:100%">'+ table_obj.html() + '</table>';
		}
	
		function menuTpl(Plugin){
			return '<li class="cmp-plugin-entry">' +
				'<a data-scroll-inter href="#'+Plugin.name+'-entry">'+Plugin.name+'</a>' +
				'<ul class="nav">' +
					'<li><a href="#'+Plugin.name+'-examples">Examples</a></li>' + 
					'<li><a href="#'+Plugin.name+'-usage">Usage</a></li>' +
				'</ul>' +
			'</li>';
		}
		
		function contentTpl(Plugin){
			
			return '<div data-scroll-target id="'+Plugin.name+'-entry" class="cmp-plugin-decs-entry">' + 
				'<h1>' + Plugin.name + '</h1>' + 
				'<div wix-ctrl="'+Plugin.name+'" wix-options=\''+getPluginInitOptions(Plugin)+'\' class="plugin-demo">' + getPluginInitMarkup(Plugin) + '</div>' + 
				'<h3>Markup</h3>' +
				'<pre class="plugin-markup">'+(getPluginDefinitionMarkup(Plugin))+'</pre>' + 
				'<h3>Options</h3>' +
				'<pre class="plugin-options">' + jsonToTable(Plugin.prototype.getDefaults())/*utils.escapeHtml(JSON.stringify(Plugin.prototype.getDefaults(),null,4))*/ + '</pre>' + 
                '<h3>Description</h3>' +
				'<p>'+getPluginDesc(Plugin)+'</p>' + 
			'</div>';
		}

		var utils = {
			escapeHtml : (function createEscaper() {
				var entityMap = {
					"&" : "&amp;",
					"<" : "&lt;",
					">" : "&gt;",
					'"' : '&quot;',
					"'" : '&#39;',
					"/" : '&#x2F;'
				};

				return function escapeHtml(string) {
					return String(string).replace(/[&<>"'\/]/g, function (s) {
						return entityMap[s];
					});
				}
			}())
		}

		var app = {
			init: function(){
				this.setAppElements();
				this.markup();
				this.bindEvents();
			},
			setAppElements: function(){
				this.$root = $('body');
				this.$sidebar = $('#sidebar');
				this.$docs = $('#docs');			
			},
			markup: function(){
				this.$root.hide();
				this.renderDocs();
				this.$root.show();
			},
			bindEvents: function(){
				this.bindScrollAnimation();
				this.bindScrollInteraction();
			},
			bindScrollAnimation: function(){
				this.$root.on('click', '[data-scroll-inter]', function(evt){
					evt.preventDefault();
					var id = evt.target.getAttribute('href');
					$('html, body').animate({
						scrollTop: $(id).offset().top
    				}, 160, function(){
						window.location.hash = id;
					});
				});			
			},
			bindScrollInteraction: function startScrollInteraction(){
				var $inter = $('[data-scroll-inter]');
				var allHashes = $('[data-scroll-target]').toArray();
				var $win = $(window);
				var $doc = $(document);
				var tollerace = 30;
				var winScrollTop = $win.scrollTop();
				var winHeight = $win.height();
				var docHeight = $doc.height();
				var timeout;
				var _winScrollTop;
				var dir = 0;
				var UP = 1
				var DOWN = -1
				var update = function (){
					winHeight = $win.height();
					docHeight = $doc.height();
					_winScrollTop = $win.scrollTop();
					dir = winScrollTop >= _winScrollTop ? UP : DOWN;
					winScrollTop = _winScrollTop;
				};
				var findElementOverTheScroll = function(){
					return allHashes.filter(function (el, i) {
						if(winScrollTop + winHeight > docHeight - $(allHashes[allHashes.length - 1]).height()/5) {
							return true;
 					    }
						if (dir === UP) {
							return winScrollTop > ($(el).position().top - ($(allHashes[i - 1]).height() / 2 || 0));
						} else {
							return winScrollTop + tollerace > $(el).position().top;
						}
					});
				};
				var updateCss = function(el){
					$inter.removeClass('current-viewed');
					if (el) {
						$('[href="#' + el.id + '"]').addClass('current-viewed');
					}
				}
				$win.scroll(function (evt) {
					clearTimeout(timeout);
					timeout = setTimeout(function () {
						update();
						var over = findElementOverTheScroll();
						updateCss(over.pop());
					}, 20);
				});
			}, 
			renderDocs: function(){
				var sidebarHTML = '';
				var docsHTML = '';
				var blackList = ['PluginTemplate'];
				var store = jQuery.fn.definePlugin.store;
				for(var pluginName in store){
					if(blackList.indexOf(pluginName) !== -1){continue;}
					var Plugin = store[pluginName];
					sidebarHTML += menuTpl(Plugin);
					docsHTML += contentTpl(Plugin);
				}
				this.$sidebar.find('.content').append(sidebarHTML);
				this.$docs.find('.content').append(docsHTML);
			}
		};
	    
			
		app.init();
	
	</script>
	
    <script>
        $(function() {
            Wix.UI.initialize({});
        });
    </script>

</body>
</html>